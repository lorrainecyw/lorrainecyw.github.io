(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{760:function(t,a,e){"use strict";e.r(a);var n=e(11),r=Object(n.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("p",[t._v("使用多线程，本质上就是为了提升性能。衡量性能的指标主要有 2 个：延迟和吞吐量")]),t._v(" "),e("ul",[e("li",[t._v("延迟：发出请求到收到相应的时间，时间越短，延迟越低，性能越好（时间维度）")]),t._v(" "),e("li",[t._v("吞吐量：单位时间能处理的请求数量，数量越多，吞吐量越高，性能越好（空间维度）")])]),t._v(" "),e("p",[t._v("所以想要提升性能，就要降低延迟，提高吞吐量。有 2 个方向：优化算法、将硬件的性能发挥到极致。在并发编程领域中，主要是提升硬件性能，也就是提高硬件的利用率，主要有两类硬件，一是 I / O，二是 CPU。所以在并发编程领域中，提升性能主要是提高 I / O 和 CPU 的利用率")]),t._v(" "),e("h2",{attrs:{id:"针对-cpu-密集型"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#针对-cpu-密集型"}},[t._v("#")]),t._v(" 针对 CPU 密集型")]),t._v(" "),e("p",[t._v("对于 CPU 密集型计算，多线程本质上是提升多核 CPU 的利用率，所以对于一个 4 核的CPU，每个核一个线程（如果一个核上多个线程，那么需要耗费线程切换的成本，得不偿失），理论上创建 4 个线程就可以了，再多创建线程也只是增加线程切换的成本。所以，对于 CPU 密集型的计算场景，理论上“"),e("strong",[t._v("线程的数量 =CPU 核数")]),t._v("”就是最合适的。不过在工程上，线程的数量一般会设置为“"),e("strong",[t._v("CPU 核数 +1")]),t._v("”，这样的话，当线程因为偶尔的内存页失效或其他原因导致阻塞时，这个额外的线程可以顶上，从而保证 CPU 的利用率")]),t._v(" "),e("h2",{attrs:{id:"针对-i-o-密集型"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#针对-i-o-密集型"}},[t._v("#")]),t._v(" 针对 I / O 密集型")]),t._v(" "),e("p",[t._v("对于 I/O 密集型的计算场景，如果 CPU 计算和 I/O 操作的耗时是 1:1，那么 2 个线程是最合适的。如果 CPU 计算和 I/O 操作的耗时是 1:2，那多少个线程合适呢？是 3 个线程，如下图所示：CPU 在 A、B、C 三个线程之间切换，对于线程 A，当 CPU 从 B、C 切换回来时，线程 A 正好执行完 I/O 操作。这样 CPU 和 I/O 设备的利用率都达到了 100%\n"),e("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2022/png/22396700/1660035356982-9e6e39dc-c8ef-4da7-ad27-23cf459f4a2d.png#clientId=uba6cd853-1496-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=366&id=u59af1899&margin=%5Bobject%20Object%5D&name=image.png&originHeight=457&originWidth=700&originalType=binary&ratio=1&rotation=0&showTitle=false&size=35463&status=done&style=none&taskId=ud61563fb-eaa4-4312-927c-abd5a530339&title=&width=560",alt:"image.png"}}),t._v("\n通过规律总结，可以发现：最佳线程数 =1 +（I/O 耗时 / CPU 耗时）\n那么对于多核来说，最佳线程数 = CPU 核数 * [ 1 +（I/O 耗时 / CPU 耗时）")])])}),[],!1,null,null,null);a.default=r.exports}}]);